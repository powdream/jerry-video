(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{43:function(e,t,r){e.exports=r(85)},48:function(e,t,r){},50:function(e,t,r){},57:function(e,t,r){},85:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),o=r(21),i=r.n(o),s=(r(48),r(4)),c=r.n(s),u=r(9),l=r(5),p=r(6),h=r(15),m=r(14),f=r(16),d=(r(50),function(){function e(t){Object(l.a)(this,e),this.isDev=t}return Object(p.a)(e,[{key:"baseUrl",value:function(){return this.isDev?"https://gm7o2xoumj.execute-api.us-east-1.amazonaws.com/dev":"https://v189wwdfoi.execute-api.us-east-1.amazonaws.com/prod"}},{key:"makeRequest",value:function(e,t,r){return new Promise(function(n,a){var o=new XMLHttpRequest;o.open(e,t);var i=null;"POST"===e&&r&&r.body&&(o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i=r.body),o.onload=function(){o.status>=200&&o.status<300?n(o.response):a({status:o.status,statusText:o.statusText})},o.onerror=function(){a({status:o.status,statusText:o.statusText})},o.send(i)})}}]),e}()),v=function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"fetch",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.makeRequest("GET",this.baseUrl()+"/v2/toplist");case 3:return t=e.sent,e.abrupt("return",JSON.parse(t));case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()}]),t}(d),g=r(41),k=r.n(g),w=r(40),y=r.n(w),E=r(37),b=r(0),O=r(42);function T(){var e=Object(E.a)(["\n    display: block;\n    margin: 0 auto;\n    border-color: red;\n"]);return T=function(){return e},e}var P=Object(b.a)(T()),j=function(e){return e.isVisible?a.a.createElement("div",{className:"sweet-loading"},a.a.createElement(O.a,{css:P,sizeUnit:"px",size:150,color:"#123abc",loading:!0})):""},L=r(17),S=r.n(L),R=(r(57),function(e){var t=e.program;return a.a.createElement("p",{className:"Program-title"},t.title)}),x=function(e){var t=e.program;return t.optionalDescription?a.a.createElement("div",{className:"Program-description"},t.description,a.a.createElement("br",null),t.optionalDescription):a.a.createElement("div",{className:"Program-description"},t.description)},A=function(e){var t=e.program;return a.a.createElement("div",{className:"Program"},a.a.createElement(R,{program:t}),a.a.createElement(x,{program:t}))},C=r(39),V={PROGRAM_CLICKED:"program-clicked",PROGRAM_VIEWER_CLICKED:"program-viewer-clicked"},N=new C.EventEmitter,I=function(e){return a.a.createElement(S.a.Item,{key:e.uniqueId,action:!0,as:"a",onClick:function(){N.emit(V.PROGRAM_CLICKED,e)}},a.a.createElement(A,{program:e}))},M=function(e){var t=e.channel;return a.a.createElement(S.a,null,t.map(I))},D=[{eventKey:"DRAMA",title:"\ub4dc\ub77c\ub9c8"},{eventKey:"ENTERTAINMENT",title:"\uc624\ub77d"},{eventKey:"DOCUMENTARY",title:"\ub2e4\ud050"},{eventKey:"EVENT",title:"\uc2dc\uc0ac"},{eventKey:"NEWS",title:"\ub274\uc2a4,\uc2a4\ud3ec\uce20"}],_=function(e,t,r){var n=D.map(function(t){var n=t.eventKey,o=t.title;return a.a.createElement(y.a,{eventKey:n,title:o,key:n},r(null==e?null:e[n]))});return a.a.createElement(k.a,{defaultActiveKey:t,transition:!1},n)},K=function(){function e(){Object(l.a)(this,e),this.toplist=null,this.isLoaded=!1,this.error=null}return Object(p.a)(e,[{key:"setTopList",value:function(e){return this.toplist=e,this.isLoaded=!0,this}},{key:"setError",value:function(e){return this.error=e,this.isLoaded=!0,this}},{key:"build",value:function(){return new G(this)}}]),e}(),G=function(){function e(t){Object(l.a)(this,e),this.toplist=t.toplist,this.isLoaded=t.isLoaded,this.error=t.error}return Object(p.a)(e,null,[{key:"empty",value:function(){return(new K).build()}},{key:"fromToplist",value:function(e){return(new K).setTopList(e).build()}},{key:"fromError",value:function(e){return(new K).setError(null==e?"Unknown error":e).build()}}]),e}(),z=function(e){var t=e.topListStatus,r=t.toplist;return t.isLoaded?t.error?_(r,"ENTERTAINMENT",function(){return a.a.createElement("div",null,t.error)}):_(r,"ENTERTAINMENT",function(e){return a.a.createElement(M,{channel:e})}):_(r,"ENTERTAINMENT",function(){return a.a.createElement(j,{isVisible:!0})})},U=function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"fetchViewerListAsync",value:function(){var e=Object(u.a)(c.a.mark(function e(t){var r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.makeRequest("GET",this.baseUrl()+"/v2/program/"+t.uniqueId+"/"+t.host);case 3:return r=e.sent,e.abrupt("return",JSON.parse(r));case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t){return e.apply(this,arguments)}}()},{key:"fetchViewerUrl",value:function(){var e=Object(u.a)(c.a.mark(function e(t,r,n){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={body:JSON.stringify(n)},e.next=4,this.makeRequest("POST",this.baseUrl()+"/v2/program/"+t+"/"+r+"/viewer",a);case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,r,n){return e.apply(this,arguments)}}()}]),t}(d),q=function(e,t){var r=Object.assign({},e);return Object.assign(r,t)},W=function(e){var t=e.programViewers;return a.a.createElement(S.a,null,t.viewers.suppliers.map(function(e){return a.a.createElement(S.a.Item,{key:e.supplierName,action:!0,as:"a",onClick:function(){N.emit(V.PROGRAM_VIEWER_CLICKED,{programId:t.programId,programHost:t.programHost,postData:q(t.viewers.basePostData,e.postData)})}},e.supplierName)}))},J=function(){function e(t){Object(l.a)(this,e),this.program=t.program,this.programViewers=t.programViewers,this.isLoaded=t.isLoaded,this.error=t.error}return Object(p.a)(e,[{key:"succeededToLoad",value:function(t){return new e({program:this.program,programViewers:t,isLoaded:!0})}},{key:"failedToLoad",value:function(t){return new e({program:this.program,error:null==t?"Unknown error":t,isLoaded:!0})}}],[{key:"loading",value:function(t){return new e({program:t,isLoaded:!1})}}]),e}(),H=function(e){var t=e.programStatus,r=t.program,n=r.title,o=r.description,i=r.optionalDescription,s=i?a.a.createElement("div",null,a.a.createElement("h3",null,n),a.a.createElement("p",null,o,a.a.createElement("br",null),i)):a.a.createElement("div",null,a.a.createElement("h3",null,n),a.a.createElement("p",null,o)),c=t.isLoaded,u=t.programViewers;t.error;return c?u?a.a.createElement("div",null,s,a.a.createElement(W,{programViewers:t.programViewers})):void 0:a.a.createElement("div",null,s,a.a.createElement(j,{isVisible:!0}))},B=function(){function e(){Object(l.a)(this,e),this.storage=[],this.size=0}return Object(p.a)(e,[{key:"push",value:function(e){this.storage[this.size++]=e}},{key:"pop",value:function(){return this.size>0?this.storage[--this.size]:null}},{key:"peek",value:function(){return this.size>0?this.storage[this.size-1]:null}},{key:"clone",value:function(){var t=new e;return t.storage=Object.assign({},this.storage),t.size=this.size,t}}]),e}(),F={TOP_LIST:"top-list",PROGRAM:"program"},X=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(l.a)(this,e),this.stack=null==t?new B:t.clone()}return Object(p.a)(e,[{key:"push",value:function(t){var r=new e(this.stack);return r.stack.push(t),r}},{key:"peek",value:function(){return this.stack.peek()}},{key:"pop",value:function(){var t=new e(this.stack);return t.stack.pop(),t}}]),e}(),Y=function(e){function t(e){var r;Object(l.a)(this,t),r=Object(h.a)(this,Object(m.a)(t).call(this,e));var n=new X;return r.state={pageStack:n.push({pageType:F.TOP_LIST,topListStatus:G.empty()})},r.toplistStore=new v(!1),r.programStore=new U(!1),r}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.fetchToplistAsync(),N.on(V.PROGRAM_CLICKED,function(){var t=Object(u.a)(c.a.mark(function t(r){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.handleProgramClicked(r);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),N.on(V.PROGRAM_VIEWER_CLICKED,function(){var t=Object(u.a)(c.a.mark(function t(r){var n,a,o;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.programId,a=r.programHost,o=r.postData,t.next=3,e.handleProgramViewerClicked(n,a,o);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}},{key:"componentWillUnmount",value:function(){N.removeAllListeners()}},{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement("h1",null,"Jerry Video")),a.a.createElement("main",null,this.renderContent()))}},{key:"currentPage",value:function(){return this.state.pageStack.peek()}},{key:"renderContent",value:function(){var e=this.currentPage();switch(console.log("renderContent(): currentPage=",e),e.pageType){case F.TOP_LIST:return function(e){var t=e.topListStatus;return a.a.createElement(z,{topListStatus:t,id:"page-toplist"})}(e);case F.PROGRAM:return function(e){var t=e.programStatus;return a.a.createElement(H,{programStatus:t,id:"page-program"})}(e);default:return""}}},{key:"updatePageStack",value:function(e){this.setState({pageStack:e(this.state.pageStack)})}},{key:"handleProgramClicked",value:function(){var e=Object(u.a)(c.a.mark(function e(t){var r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("handleProgramClicked():",t),r=J.loading(t),this.updatePageStack(function(e){return e.push({pageType:F.PROGRAM,programStatus:r})}),e.next=5,this.fetchProgramViewersAsync(t,r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleProgramViewerClicked",value:function(){var e=Object(u.a)(c.a.mark(function e(t,r,n){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("handleProgramViewerClicked():",{id:t,host:r,body:n}),e.prev=1,e.next=4,this.programStore.fetchViewerUrl(t,r,n);case 4:a=e.sent,window.open(a,"_blank"),console.log("handleProgramViewerClicked(): url:",a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("handleProgramViewerClicked(): error:",e.t0);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"fetchToplistAsync",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.toplistStore.fetch();case 3:t=e.sent,console.log("fetchToplistAsync(): success:",t),this.updatePageStack(function(e){return e.pop().push({pageType:F.TOP_LIST,topListStatus:G.fromToplist(t)})}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("fetchToplistAsync(): failure:",e.t0),this.updatePageStack(function(t){return t.pop().push({pageType:F.TOP_LIST,topListStatus:G.fromError(e.t0.statusText)})});case 12:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"fetchProgramViewersAsync",value:function(){var e=Object(u.a)(c.a.mark(function e(t,r){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.programStore.fetchViewerListAsync(t);case 3:n=e.sent,console.log("fetchProgramViewersAsync(): success:",n),this.updatePageStack(function(e){return e.pop().push({pageType:F.PROGRAM,programStatus:r.succeededToLoad(n)})}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("fetchProgramViewersAsync(): failure:",e.t0),this.updatePageStack(function(t){return t.pop().push({pageType:F.PROGRAM,programStatus:r.failedToLoad(e.t0.statusText)})});case 12:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t,r){return e.apply(this,arguments)}}()}]),t}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(Y,{id:"app"}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[43,1,2]]]);
//# sourceMappingURL=main.7abdac6f.chunk.js.map